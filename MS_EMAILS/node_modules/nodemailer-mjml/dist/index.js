"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.buildMjmlTemplate = exports.nodemailerMjmlPlugin = void 0;
const buildMjmlTemplate_1 = require("./helpers/buildMjmlTemplate");
Object.defineProperty(exports, "buildMjmlTemplate", { enumerable: true, get: function () { return buildMjmlTemplate_1.buildMjmlTemplate; } });
const nodemailerMjmlPlugin = (options) => {
    return async (mail, callback) => {
        if (mail.data.html || !mail.data?.templateName)
            return callback();
        try {
            const { templateData, templateName } = mail.data;
            const mailHtmlContent = await (0, buildMjmlTemplate_1.buildMjmlTemplate)(options, templateName, templateData);
            Object.assign(mail.data, { html: mailHtmlContent });
            return callback();
        }
        catch (error) {
            return callback(error);
        }
    };
};
exports.nodemailerMjmlPlugin = nodemailerMjmlPlugin;
exports.default = nodemailerMjmlPlugin;
